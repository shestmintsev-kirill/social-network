{"version":3,"sources":["Hooks/useIsAuth.ts","../node_modules/antd/es/comment/index.js","pages/ChatPage.tsx"],"names":["useIsAuth","router","useHistory","useSelector","state","auth","isAuth","push","__rest","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","Comment","_a","actions","author","avatar","children","className","content","customizePrefixCls","prefixCls","datetime","otherProps","_React$useContext","React","ConfigContext","getPrefixCls","direction","avatarDom","concat","src","alt","actionDom","map","action","index","key","authorContent","contentDom","cls","classNames","_defineProperty","_extends","nestedChildren","renderNested","TextArea","Input","Chat","dispatch","useDispatch","status","chat","useEffect","startMessagesListening","stopMessagesListening","Messages","AddMessageForm","messages","messageAnchorRef","useRef","useState","isAutoScroll","setIsAutoScroll","current","scrollIntoView","behavior","style","height","overflowY","onScroll","element","currentTarget","scrollHeight","scrollTop","clientHeight","m","Message","message","id","ref","Array","from","a","active","memo","userName","photo","setMessage","onChange","value","disabled","onClick","sendMessage","ChatPage"],"mappings":"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","file":"static/js/5.04c886b5.chunk.js","sourcesContent":["import { useSelector } from 'react-redux';\nimport { useHistory } from 'react-router-dom';\nimport { AppStateType } from '../redux/redux-store';\n\nexport const useIsAuth = () => {\n    const router = useHistory();\n    const isAuth = useSelector((state: AppStateType) => state.auth.isAuth);\n\n    if (!isAuth) {\n        router.push('/login');\n    }\n};\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport { ConfigContext } from '../config-provider';\n\nvar Comment = function Comment(_a) {\n  var actions = _a.actions,\n      author = _a.author,\n      avatar = _a.avatar,\n      children = _a.children,\n      className = _a.className,\n      content = _a.content,\n      customizePrefixCls = _a.prefixCls,\n      datetime = _a.datetime,\n      otherProps = __rest(_a, [\"actions\", \"author\", \"avatar\", \"children\", \"className\", \"content\", \"prefixCls\", \"datetime\"]);\n\n  var _React$useContext = React.useContext(ConfigContext),\n      getPrefixCls = _React$useContext.getPrefixCls,\n      direction = _React$useContext.direction;\n\n  var renderNested = function renderNested(prefixCls, nestedChildren) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: classNames(\"\".concat(prefixCls, \"-nested\"))\n    }, nestedChildren);\n  };\n\n  var prefixCls = getPrefixCls('comment', customizePrefixCls);\n  var avatarDom = avatar ? /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-avatar\")\n  }, typeof avatar === 'string' ? /*#__PURE__*/React.createElement(\"img\", {\n    src: avatar,\n    alt: \"comment-avatar\"\n  }) : avatar) : null;\n  var actionDom = actions && actions.length ? /*#__PURE__*/React.createElement(\"ul\", {\n    className: \"\".concat(prefixCls, \"-actions\")\n  }, actions.map(function (action, index) {\n    return /*#__PURE__*/React.createElement(\"li\", {\n      key: \"action-\".concat(index)\n    }, action) // eslint-disable-line react/no-array-index-key\n    ;\n  })) : null;\n  var authorContent = (author || datetime) && /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-content-author\")\n  }, author && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"\".concat(prefixCls, \"-content-author-name\")\n  }, author), datetime && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"\".concat(prefixCls, \"-content-author-time\")\n  }, datetime));\n  var contentDom = /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-content\")\n  }, authorContent, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-content-detail\")\n  }, content), actionDom);\n  var cls = classNames(prefixCls, _defineProperty({}, \"\".concat(prefixCls, \"-rtl\"), direction === 'rtl'), className);\n  return /*#__PURE__*/React.createElement(\"div\", _extends({}, otherProps, {\n    className: cls\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"\".concat(prefixCls, \"-inner\")\n  }, avatarDom, contentDom), children ? renderNested(prefixCls, children) : null);\n};\n\nexport default Comment;","import { Input, Button, Skeleton } from 'antd';\nimport React, { useEffect, useRef, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Comment, Avatar } from 'antd';\nimport {\n    ChatMessageType,\n    sendMessage,\n    startMessagesListening,\n    stopMessagesListening\n} from '../redux/chat-reducer';\nimport { AppStateType } from '../redux/redux-store';\nimport { useIsAuth } from '../Hooks/useIsAuth';\n\nconst { TextArea } = Input;\n\nconst ChatPage: React.FC = () => {\n    useIsAuth();\n\n    return <Chat />;\n};\n\nconst Chat: React.FC = () => {\n    const dispatch = useDispatch();\n    const status = useSelector((state: AppStateType) => state.chat.status);\n\n    useEffect(() => {\n        dispatch(startMessagesListening());\n        return () => {\n            dispatch(stopMessagesListening());\n        };\n    }, [dispatch]);\n\n    return (\n        <div>\n            {status === 'error' && <div>Disconnect, restart page</div>}\n            <div>\n                <Messages />\n                <AddMessageForm />\n            </div>\n        </div>\n    );\n};\n\nconst Messages: React.FC = () => {\n    const messages = useSelector((state: AppStateType) => state.chat.messages);\n    const messageAnchorRef = useRef<HTMLDivElement>(null);\n    const [isAutoScroll, setIsAutoScroll] = useState(true);\n\n    const scrollHandler = (e: React.UIEvent<HTMLDivElement, UIEvent>) => {\n        let element = e.currentTarget;\n        if (element.scrollHeight - element.scrollTop !== element.clientHeight) {\n            setIsAutoScroll(false);\n        } else {\n            setIsAutoScroll(true);\n        }\n    };\n\n    useEffect(() => {\n        if (isAutoScroll) {\n            messageAnchorRef.current?.scrollIntoView({ behavior: 'smooth' });\n        }\n    }, [isAutoScroll, messages]);\n\n    if (!messages.length) {\n        return (\n            <>\n                {Array.from(Array(3)).map((a, i) => (\n                    <Skeleton active avatar key={i} />\n                ))}\n            </>\n        );\n    }\n\n    return (\n        <div style={{ height: '400px', overflowY: 'auto' }} onScroll={scrollHandler}>\n            {messages.map((m: ChatMessageType) => (\n                <Message message={m} key={m.id} />\n            ))}\n            <div ref={messageAnchorRef}></div>\n        </div>\n    );\n};\n\nconst Message: React.FC<{ message: ChatMessageType }> = React.memo(({ message }) => {\n    return (\n        <Comment\n            author={message.userName}\n            avatar={<Avatar src={message.photo} alt=\"photo\" />}\n            content={<p>{message.message}</p>}\n        />\n    );\n});\n\nconst AddMessageForm: React.FC = () => {\n    const [message, setMessage] = useState<string>('');\n    const status = useSelector((state: AppStateType) => state.chat.status);\n    const dispatch = useDispatch();\n\n    const sendMessageHendler = () => {\n        if (message.length) {\n            dispatch(sendMessage(message));\n            setMessage('');\n        }\n    };\n\n    return (\n        <div>\n            <TextArea onChange={(e) => setMessage(e.currentTarget.value)} value={message} />\n            <Button disabled={status !== 'ready' || !message.length} onClick={sendMessageHendler}>\n                Send\n            </Button>\n        </div>\n    );\n};\n\nexport default ChatPage;\n"],"sourceRoot":""}